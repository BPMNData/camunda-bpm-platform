<beans xmlns="http://www.springframework.org/schema/beans" xmlns:security="http://www.springframework.org/schema/security" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.springframework.org/schema/beans
          http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
          http://www.springframework.org/schema/security
          http://www.springframework.org/schema/security/spring-security-3.1.xsd">
          
  <!-- spring security authentication service bootstrapping -->

  <bean id="cockpitRuntimeDelegate" class="org.camunda.bpm.cockpit.Cockpit" factory-method="getRuntimeDelegate">
    <property name="authenticationService" ref="authenticationService" />
  </bean>

  <bean id="authenticationService" class="org.camunda.bpm.common.auth.impl.spring.SpringSecurityAuthenticationService">
    <property name="authenticationManager" ref="org.springframework.security.authenticationManager" />

    <!-- set to true if your LDAP uses self-signed certificates. 
           WARNING: unsafe, better install the certificate to your JVM trust store. -->
    <property name="acceptAllSslCertificates" value="true" />

  </bean>

  <!-- spring security configuration -->
  <security:http>

    <!-- allow access to auth resources -->
    <security:intercept-url pattern="/api/cockpit/auth/**" access="IS_AUTHENTICATED_ANONYMOUSLY" />
    <!-- allow access to static plugin resources -->
    <security:intercept-url pattern="/api/cockpit/plugin/**/static/**" access="IS_AUTHENTICATED_ANONYMOUSLY" />
    <!-- protect access to api resources -->
    <security:intercept-url pattern="/api/**" access="ROLE_COCKPIT_USER,ROLE_ADMINISTRATOR" />
    <security:http-basic entry-point-ref="defaultAuthenticationEntryPoint" />
  </security:http>
    
  <bean id="defaultAuthenticationEntryPoint" class="org.camunda.bpm.common.auth.impl.spring.DefaultAuthenticationEntryPoint" />

  <!-- authentication manager configuration -->
  <security:authentication-manager>  
    <security:authentication-provider ref="authenticationProvider" />    
  </security:authentication-manager>
  
  <bean id="authenticationProvider" class="org.camunda.bpm.common.auth.impl.spring.ForwardingAuthenticationProvider" />
  
</beans>