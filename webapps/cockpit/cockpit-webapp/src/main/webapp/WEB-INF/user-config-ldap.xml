<beans xmlns="http://www.springframework.org/schema/beans" xmlns:security="http://www.springframework.org/schema/security" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.springframework.org/schema/beans
          http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
          http://www.springframework.org/schema/security
          http://www.springframework.org/schema/security/spring-security-3.1.xsd">

  <!-- load LDAP properties -->
  <bean class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
    <property name="location">
      <value>ldap.properties</value>
    </property>
  </bean>

  <bean id="contextSource" class="org.springframework.security.ldap.DefaultSpringSecurityContextSource">
    <constructor-arg value="${ldap.hostname}${ldap.baseDn}" />
    <property name="userDn" value="${ldap.userDn}" />
    <property name="password" value="${ldap.password}" />
  </bean>

  <bean id="authenticationProvider" class="org.springframework.security.ldap.authentication.LdapAuthenticationProvider">
    <constructor-arg>
      <bean class="org.springframework.security.ldap.authentication.BindAuthenticator">
        <constructor-arg ref="contextSource" />
        <property name="userDnPatterns">
          <list>
            <value>${ldap.userDnPatterns}</value>
          </list>
        </property>
      </bean>
    </constructor-arg>
    <constructor-arg>
      <bean class="org.springframework.security.ldap.userdetails.DefaultLdapAuthoritiesPopulator">
        <constructor-arg ref="contextSource" />
        <constructor-arg value="${ldap.groupBase}" />
        <property name="groupRoleAttribute" value="${ldap.groupRoleAttribute}" />
        <property name="groupSearchFilter" value="${ldap.groupSearchFilter}" />
      </bean>
    </constructor-arg>
    <property name="authoritiesMapper" ref="camundaGrantedAuthoritiesMapper" />
  </bean>

  <!-- map company LDAP roles to cockpit roles -->
  <bean id="camundaGrantedAuthoritiesMapper" class="org.camunda.bpm.common.auth.impl.spring.CamundaGrantedAuthoritiesMapper">
    <property name="roleNameMap">
      <map>
        <entry key="ROLE_MITARBEITER" value="ROLE_COCKPIT_USER" />
      </map>
    </property>
  </bean>

</beans>